{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load l10n %}

{% block data_rapat %}
  <div class="antialiased bg-gray-800  ">
    {% include 'components/header_tambah_user.html' %}


    <div class="p-4 pt-20">
      <div class="flex text-white text-2xl justify-between">
        <div class="">
          TAMBAH ANGGOTA
        </div>
        <button data-modal-target="authentication-modal" data-modal-toggle="authentication-modal" class="block text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" type="button">
          TAMBAH 
        </button>
      </div>
      <div class="mt-3" id="table_tambah_user"></div>
      <div class="mx-auto">
        <script>
          document.addEventListener("DOMContentLoaded", function () {
            var table = new Tabulator("#table_tambah_user", {
              layout: "fitColumns", // Adjust columns to fit the table width
              responsiveLayout: "collapse",
              ajaxURL: "{% url 'tambah_user_api' %}", // URL to fetch data
              placeholder:"Data tidak tersedia",
              ajaxConfig: "GET", // HTTP method
              pagination:true, //enable pagination
              paginationMode:"remote", //enable remote pagination
              paginationSize: 15, // Jumlah data per halaman
              paginationCounter:"rows",
              dataTree:true,
              dataTreeStartExpanded:false,
              columns: [
                { title: "NO", field: "no", hozAlign : "center", headerHozAlign: "center", width: 200 ,  formatter: function (cell) {

                  let pageSize = cell.getTable().getPageSize();
                  let page = cell.getTable().getPage();
                  return ((page - 1) * pageSize + cell.getRow().getPosition()) ;
                }, },
                { title: "NAMA", field: "nama" , headerHozAlign: "center" },
                { title: "AKSI", field: "actions", hozAlign: "center", headerHozAlign: "center",git
                  formatter: function(cell, formatterParams, onRendered) {
                    return `
                  
                    <div class="flex space-x-2 justify-center gap-2">
                       <button data-modal-target="non_aktif_user{{ data.id }}" data-modal-toggle="non_aktif_user{{ data.nip }}" class="non_aktif_user_organisasi bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded focus:ring-4 focus:ring-red-300" title="NON AKTIF">
                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" viewBox="0 0 24 24">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/>
                        </svg>
                      </button>
                       <button data-modal-target="ganti_jabatan{{ data.nip }}" data-modal-toggle="ganti_jabatan{{ data.nip }}" class="ganti_jabatan_user bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded focus:ring-4 focus:ring-blue-300" title="GANTI/UBAH JABATAN">
                       <svg class="w-4 h-4 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.484 9.166 15 7h5m0 0-3-3m3 3-3 3M4 17h4l1.577-2.253M4 7h4l7 10h5m0 0-3 3m3-3-3-3"/>
                      </svg>
                      </button>
                    </div>
                    
                    `;
                  },

                  cellClick: function(e, cell) {
                    const rowData = cell.getRow().getData();

                    const nonAktifBtn = e.target.closest('.non_aktif_user_organisasi');
                    if (nonAktifBtn) {

                      const modalId = `non_aktif_user${rowData.nip}`;
                      const modalElement = document.getElementById(modalId);

                      if (modalElement) {
                        const modal = new Modal(modalElement);
                        modal.show();
                      }
                    }

                    const GantiJabatanBtn = e.target.closest('.ganti_jabatan_user');
                    if (GantiJabatanBtn) {

                      const modalId = `ganti_jabatan${rowData.nip}`;
                      const modalElement = document.getElementById(modalId);

                      if (modalElement) {
                        const modal = new Modal(modalElement);
                        modal.show();
                      }
                    }
                  }
                }
              ]
            });
          });
        </script>

      </div>

    </div>
    {% include 'tambah_user/modal/tambah.html' %}



{% endblock %}
